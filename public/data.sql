TRUNCATE TABLE logs;
CREATE TEMPORARY TABLE TEMP (
                `id` BIGINT( 20 ) NOT NULL AUTO_INCREMENT ,
 `from_ip` BIGINT( 20 ) NOT NULL ,
 `to_ip` BIGINT( 20 ) NOT NULL ,
 `port` INT( 11 ) NOT NULL ,
 `protocol` INT( 11 ) NOT NULL ,
 `from_8_subnet` BIGINT( 20 ) NOT NULL ,
 `from_16_subnet` BIGINT( 20 ) NOT NULL ,
 `from_24_subnet` BIGINT( 20 ) NOT NULL ,
 `to_8_subnet` BIGINT( 20 ) NOT NULL ,
 `to_16_subnet` BIGINT( 20 ) NOT NULL ,
 `to_24_subnet` BIGINT( 20 ) NOT NULL ,
PRIMARY KEY (  `id` ) ,
INDEX  `all` (  `id` ,  `from_ip` ,  `to_ip` ,  `port` ,  `protocol` , `from_8_subnet` ,  `from_16_subnet` , `from_24_subnet` ,  `to_8_subnet` ,  `to_16_subnet` , `to_24_subnet` )
);
INSERT INTO TEMP (from_ip, to_ip, port, protocol, from_8_subnet, from_16_subnet, from_24_subnet, to_8_subnet, to_16_subnet, to_24_subnet) VALUES(171249062,168496539,36952,6,167772160,171245568,171248896,167772160,168493056,168496384),(168496690,171249181,64327,6,167772160,168493056,168496640,167772160,171245568,171249152),(168496691,171249171,64327,6,167772160,168493056,168496640,167772160,171245568,171249152),(171249163,168496651,64327,6,167772160,171245568,171249152,167772160,168493056,168496640),(171249206,168496653,64327,6,167772160,171245568,171249152,167772160,168493056,168496640),(168496692,171249181,64327,6,167772160,168493056,168496640,167772160,171245568,171249152),(168496693,171249171,64327,6,167772160,168493056,168496640,167772160,171245568,171249152),(171249204,168496651,64327,6,167772160,171245568,171249152,167772160,168493056,168496640),(171249171,168496659,64327,6,167772160,171245568,171249152,167772160,168493056,168496640),(171249205,168496652,64327,6,167772160,171245568,171249152,167772160,168493056,168496640),(168496413,171248924,64327,6,167772160,168493056,168496384,167772160,171245568,171248896),(171249166,168496654,64327,6,167772160,171245568,171249152,167772160,168493056,168496640),(171249162,168496659,64327,6,167772160,171245568,171249152,167772160,168493056,168496640),(171249169,168496657,64327,6,167772160,171245568,171249152,167772160,168493056,168496640),(171249167,168496655,64327,6,167772160,171245568,171249152,167772160,168493056,168496640),(171249163,168496660,64327,6,167772160,171245568,171249152,167772160,168493056,168496640),(171249172,168496660,64327,6,167772160,171245568,171249152,167772160,168493056,168496640),(168496412,171248924,64327,6,167772160,168493056,168496384,167772160,171245568,171248896),(168429020,167863503,554,6,167772160,168427520,168428800,167772160,167837696,167863296),(171249170,168496658,64327,6,167772160,171245568,171249152,167772160,168493056,168496640),(171249210,168496657,64327,6,167772160,171245568,171249152,167772160,168493056,168496640),(171249209,168496656,64327,6,167772160,171245568,171249152,167772160,168493056,168496640),(171249062,168496539,36952,6,167772160,171245568,171248896,167772160,168493056,168496384),(168496693,171249171,64327,6,167772160,168493056,168496640,167772160,171245568,171249152),(171249062,168496539,36952,6,167772160,171245568,171248896,167772160,168493056,168496384),(168496690,171249181,64327,6,167772160,168493056,168496640,167772160,171245568,171249152),(168496691,171249171,64327,6,167772160,168493056,168496640,167772160,171245568,171249152),(171249163,168496651,64327,6,167772160,171245568,171249152,167772160,168493056,168496640),(171249206,168496653,64327,6,167772160,171245568,171249152,167772160,168493056,168496640),(168496692,171249181,64327,6,167772160,168493056,168496640,167772160,171245568,171249152),(168496693,171249171,64327,6,167772160,168493056,168496640,167772160,171245568,171249152),(171249204,168496651,64327,6,167772160,171245568,171249152,167772160,168493056,168496640),(171249171,168496659,64327,6,167772160,171245568,171249152,167772160,168493056,168496640),(171249205,168496652,64327,6,167772160,171245568,171249152,167772160,168493056,168496640),(168496413,171248924,64327,6,167772160,168493056,168496384,167772160,171245568,171248896),(171249166,168496654,64327,6,167772160,171245568,171249152,167772160,168493056,168496640),(171249162,168496659,64327,6,167772160,171245568,171249152,167772160,168493056,168496640),(171249169,168496657,64327,6,167772160,171245568,171249152,167772160,168493056,168496640),(171249167,168496655,64327,6,167772160,171245568,171249152,167772160,168493056,168496640),(171249163,168496660,64327,6,167772160,171245568,171249152,167772160,168493056,168496640),(171249172,168496660,64327,6,167772160,171245568,171249152,167772160,168493056,168496640),(168496412,171248924,64327,6,167772160,168493056,168496384,167772160,171245568,171248896),(168429020,167863503,554,6,167772160,168427520,168428800,167772160,167837696,167863296),(171249170,168496658,64327,6,167772160,171245568,171249152,167772160,168493056,168496640),(171249210,168496657,64327,6,167772160,171245568,171249152,167772160,168493056,168496640),(171249209,168496656,64327,6,167772160,171245568,171249152,167772160,168493056,168496640),(171249062,168496539,36952,6,167772160,171245568,171248896,167772160,168493056,168496384),(168496693,171249171,64327,6,167772160,168493056,168496640,167772160,171245568,171249152),(171249205,168496652,64327,6,167772160,171245568,171249152,167772160,168493056,168496640),(168496413,171248924,64327,6,167772160,168493056,168496384,167772160,171245568,171248896),(171249166,168496654,64327,6,167772160,171245568,171249152,167772160,168493056,168496640),(171249162,168496659,64327,6,167772160,171245568,171249152,167772160,168493056,168496640),(171249169,168496657,64327,6,167772160,171245568,171249152,167772160,168493056,168496640),(171249167,168496655,64327,6,167772160,171245568,171249152,167772160,168493056,168496640),(171249163,168496660,64327,6,167772160,171245568,171249152,167772160,168493056,168496640),(171249172,168496660,64327,6,167772160,171245568,171249152,167772160,168493056,168496640),(168496412,171248924,64327,6,167772160,168493056,168496384,167772160,171245568,171248896),(168429020,167863503,554,6,167772160,168427520,168428800,167772160,167837696,167863296),(171249170,168496658,64327,6,167772160,171245568,171249152,167772160,168493056,168496640),(171249210,168496657,64327,6,167772160,171245568,171249152,167772160,168493056,168496640),(171249209,168496656,64327,6,167772160,171245568,171249152,167772160,168493056,168496640),(171249062,168496539,36952,6,167772160,171245568,171248896,167772160,168493056,168496384),(168496693,171249171,64327,6,167772160,168493056,168496640,167772160,171245568,171249152),(171249062,168496539,36952,6,167772160,171245568,171248896,167772160,168493056,168496384),(168496690,171249181,64327,6,167772160,168493056,168496640,167772160,171245568,171249152),(168496691,171249171,64327,6,167772160,168493056,168496640,167772160,171245568,171249152),(171249163,168496651,64327,6,167772160,171245568,171249152,167772160,168493056,168496640),(171249206,168496653,64327,6,167772160,171245568,171249152,167772160,168493056,168496640),(168496692,171249181,64327,6,167772160,168493056,168496640,167772160,171245568,171249152),(168496693,171249171,64327,6,167772160,168493056,168496640,167772160,171245568,171249152),(171249204,168496651,64327,6,167772160,171245568,171249152,167772160,168493056,168496640),(171249171,168496659,64327,6,167772160,171245568,171249152,167772160,168493056,168496640),(171249205,168496652,64327,6,167772160,171245568,171249152,167772160,168493056,168496640),(168496413,171248924,64327,6,167772160,168493056,168496384,167772160,171245568,171248896),(171249166,168496654,64327,6,167772160,171245568,171249152,167772160,168493056,168496640),(171249162,168496659,64327,6,167772160,171245568,171249152,167772160,168493056,168496640),(171249169,168496657,64327,6,167772160,171245568,171249152,167772160,168493056,168496640),(171249167,168496655,64327,6,167772160,171245568,171249152,167772160,168493056,168496640),(171249163,168496660,64327,6,167772160,171245568,171249152,167772160,168493056,168496640),(171249172,168496660,64327,6,167772160,171245568,171249152,167772160,168493056,168496640),(168496412,171248924,64327,6,167772160,168493056,168496384,167772160,171245568,171248896),(171249205,168496652,64327,6,167772160,171245568,171249152,167772160,168493056,168496640),(168496413,171248924,64327,6,167772160,168493056,168496384,167772160,171245568,171248896),(171249166,168496654,64327,6,167772160,171245568,171249152,167772160,168493056,168496640),(171249162,168496659,64327,6,167772160,171245568,171249152,167772160,168493056,168496640),(171249169,168496657,64327,6,167772160,171245568,171249152,167772160,168493056,168496640),(171249167,168496655,64327,6,167772160,171245568,171249152,167772160,168493056,168496640),(171249163,168496660,64327,6,167772160,171245568,171249152,167772160,168493056,168496640),(171249172,168496660,64327,6,167772160,171245568,171249152,167772160,168493056,168496640),(168496412,171248924,64327,6,167772160,168493056,168496384,167772160,171245568,171248896),(168429020,167863503,554,6,167772160,168427520,168428800,167772160,167837696,167863296),(171249170,168496658,64327,6,167772160,171245568,171249152,167772160,168493056,168496640),(171249210,168496657,64327,6,167772160,171245568,171249152,167772160,168493056,168496640),(171249209,168496656,64327,6,167772160,171245568,171249152,167772160,168493056,168496640),(171249062,168496539,36952,6,167772160,171245568,171248896,167772160,168493056,168496384),(168496693,171249171,64327,6,167772160,168493056,168496640,167772160,171245568,171249152),(171249062,168496539,36952,6,167772160,171245568,171248896,167772160,168493056,168496384),(168496690,171249181,64327,6,167772160,168493056,168496640,167772160,171245568,171249152),(168496691,171249171,64327,6,167772160,168493056,168496640,167772160,171245568,171249152),(171249163,168496651,64327,6,167772160,171245568,171249152,167772160,168493056,168496640),(171249206,168496653,64327,6,167772160,171245568,171249152,167772160,168493056,168496640),(168496692,171249181,64327,6,167772160,168493056,168496640,167772160,171245568,171249152),(168496693,171249171,64327,6,167772160,168493056,168496640,167772160,171245568,171249152),(171249204,168496651,64327,6,167772160,171245568,171249152,167772160,168493056,168496640),(171249171,168496659,64327,6,167772160,171245568,171249152,167772160,168493056,168496640),(171249205,168496652,64327,6,167772160,171245568,171249152,167772160,168493056,168496640),(168496413,171248924,64327,6,167772160,168493056,168496384,167772160,171245568,171248896),(171249166,168496654,64327,6,167772160,171245568,171249152,167772160,168493056,168496640),(171249162,168496659,64327,6,167772160,171245568,171249152,167772160,168493056,168496640),(171249169,168496657,64327,6,167772160,171245568,171249152,167772160,168493056,168496640),(171249167,168496655,64327,6,167772160,171245568,171249152,167772160,168493056,168496640),(171249163,168496660,64327,6,167772160,171245568,171249152,167772160,168493056,168496640),(171249172,168496660,64327,6,167772160,171245568,171249152,167772160,168493056,168496640),(168496412,171248924,64327,6,167772160,168493056,168496384,167772160,171245568,171248896),(460549386,2439738833,3695,6,452984832,460521472,460549376,2432696320,2439708672,2439738624);
Insert into logs
SELECT null, t.from_ip, t.to_ip, t.port, t.protocol, t.from_8_subnet, t.from_16_subnet, t.from_24_subnet, t.to_8_subnet, t.to_16_subnet, t.to_24_subnet, COUNT(*), null, 0, 1, 0
FROM TEMP t
group by t.from_ip, t.to_ip, t.port, t.protocol, t.from_8_subnet, t.from_16_subnet, t.from_24_subnet, t.to_8_subnet, t.to_16_subnet, t.to_24_subnet;
DROP TABLE TEMP;
